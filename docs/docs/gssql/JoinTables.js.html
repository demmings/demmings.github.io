<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>JoinTables.js - gsSQL</title>
    
    <meta name="description" content="Query Google Sheets using standard SQL SELECT syntax." />
    
        <meta name="keywords" content="Google, Sheets, Query, SQL, SELECT" />
        <meta name="keyword" content="Google, Sheets, Query, SQL, SELECT" />
    
    
    
    <meta property="og:title" content="gsSQL Sheets Custom Function"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://demmings.github.io/img/logo.png"/>
    <meta property="og:site_name" content="gsSQL"/>
    <meta property="og:url" content="https://demmings.github.io/"/>
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <input type="text" id="nav-search" placeholder="Search" />
    
    
    <h2><a href="index.html">Home</a></h2><h2><a href="https://demmings.github.io" target="_blank" class="menu-item" id="website_link" >Project Website</a></h2><h2><a href="https://github.com/demmings/gsSQL" target="_blank" class="menu-item" id="website_link" >Github Website</a></h2><h3>Classes</h3><ul><li><a href="BindData.html">BindData</a><ul class='methods'><li data-type='method'><a href="BindData.html#add">add</a></li><li data-type='method'><a href="BindData.html#addList">addList</a></li><li data-type='method'><a href="BindData.html#clear">clear</a></li><li data-type='method'><a href="BindData.html#get">get</a></li><li data-type='method'><a href="BindData.html#getBindDataList">getBindDataList</a></li></ul></li><li><a href="CalculatedField.html">CalculatedField</a><ul class='methods'><li data-type='method'><a href="CalculatedField.html#createAssignmentStatments">createAssignmentStatments</a></li><li data-type='method'><a href="CalculatedField.html#evaluateCalculatedField">evaluateCalculatedField</a></li><li data-type='method'><a href="CalculatedField.html#getData">getData</a></li><li data-type='method'><a href="CalculatedField.html#sqlServerCalcFields">sqlServerCalcFields</a></li><li data-type='method'><a href="CalculatedField.html#sqlServerFunctions">sqlServerFunctions</a></li></ul></li><li><a href="CondLexer.html">CondLexer</a><ul class='methods'><li data-type='method'><a href="CondLexer.html#isFinishedWord">isFinishedWord</a></li><li data-type='method'><a href="CondLexer.html#isStartOrEndOfString">isStartOrEndOfString</a></li><li data-type='method'><a href="CondLexer.html#readBindVariable">readBindVariable</a></li><li data-type='method'><a href="CondLexer.html#readGroupSymbol">readGroupSymbol</a></li><li data-type='method'><a href="CondLexer.html#readMathOperator">readMathOperator</a></li><li data-type='method'><a href="CondLexer.html#readNextToken">readNextToken</a></li><li data-type='method'><a href="CondLexer.html#readOperator">readOperator</a></li><li data-type='method'><a href="CondLexer.html#readString">readString</a></li><li data-type='method'><a href="CondLexer.html#readWord">readWord</a></li></ul></li><li><a href="CondParser.html">CondParser</a><ul class='methods'><li data-type='method'><a href="CondParser.html#parseBaseExpression">parseBaseExpression</a></li><li data-type='method'><a href="CondParser.html#parseConditionExpression">parseConditionExpression</a></li><li data-type='method'><a href="CondParser.html#parseExpressionsRecursively">parseExpressionsRecursively</a></li><li data-type='method'><a href="CondParser.html#parseGroupExpression">parseGroupExpression</a></li><li data-type='method'><a href="CondParser.html#parseLogicalExpression">parseLogicalExpression</a></li><li data-type='method'><a href="CondParser.html#parseSelectExistsSubQuery">parseSelectExistsSubQuery</a></li><li data-type='method'><a href="CondParser.html#parseSelectIn">parseSelectIn</a></li><li data-type='method'><a href="CondParser.html#parseWordExpression">parseWordExpression</a></li><li data-type='method'><a href="CondParser.html#readNextToken">readNextToken</a></li><li data-type='method'><a href="CondParser.html#.groupBracketIncrementer">groupBracketIncrementer</a></li><li data-type='method'><a href="CondParser.html#.parse">parse</a></li></ul></li><li><a href="ConglomerateRecord.html">ConglomerateRecord</a><ul class='methods'><li data-type='method'><a href="ConglomerateRecord.html#squish">squish</a></li><li data-type='method'><a href="ConglomerateRecord.html#.aggregateColumn">aggregateColumn</a></li><li data-type='method'><a href="ConglomerateRecord.html#.maxCase">maxCase</a></li><li data-type='method'><a href="ConglomerateRecord.html#.minCase">minCase</a></li></ul></li><li><a href="CorrelatedSubQuery.html">CorrelatedSubQuery</a><ul class='methods'><li data-type='method'><a href="CorrelatedSubQuery.html#replaceOuterFieldValueInCorrelatedWhere">replaceOuterFieldValueInCorrelatedWhere</a></li><li data-type='method'><a href="CorrelatedSubQuery.html#select">select</a></li><li data-type='method'><a href="CorrelatedSubQuery.html#traverseWhere">traverseWhere</a></li></ul></li><li><a href="DerivedTable.html">DerivedTable</a><ul class='methods'><li data-type='method'><a href="DerivedTable.html#createTable">createTable</a></li><li data-type='method'><a href="DerivedTable.html#getTableData">getTableData</a></li><li data-type='method'><a href="DerivedTable.html#isDerivedTable">isDerivedTable</a></li><li data-type='method'><a href="DerivedTable.html#setIsOuterJoin">setIsOuterJoin</a></li><li data-type='method'><a href="DerivedTable.html#setLeftField">setLeftField</a></li><li data-type='method'><a href="DerivedTable.html#setLeftRecords">setLeftRecords</a></li><li data-type='method'><a href="DerivedTable.html#setRightField">setRightField</a></li><li data-type='method'><a href="DerivedTable.html#.getCombinedColumnTitles">getCombinedColumnTitles</a></li></ul></li><li><a href="JoinTables.html">JoinTables</a><ul class='methods'><li data-type='method'><a href="JoinTables.html#getJoinedTableInfo">getJoinedTableInfo</a></li><li data-type='method'><a href="JoinTables.html#isDerivedTable">isDerivedTable</a></li><li data-type='method'><a href="JoinTables.html#joinCondition">joinCondition</a></li><li data-type='method'><a href="JoinTables.html#joinNextTable">joinNextTable</a></li><li data-type='method'><a href="JoinTables.html#load">load</a></li><li data-type='method'><a href="JoinTables.html#resolveCondition">resolveCondition</a></li><li data-type='method'><a href="JoinTables.html#setBindVariables">setBindVariables</a></li><li data-type='method'><a href="JoinTables.html#setPrimaryTableInfo">setPrimaryTableInfo</a></li><li data-type='method'><a href="JoinTables.html#setTableFields">setTableFields</a></li><li data-type='method'><a href="JoinTables.html#setTableInfo">setTableInfo</a></li><li data-type='method'><a href="JoinTables.html#.andJoinIds">andJoinIds</a></li><li data-type='method'><a href="JoinTables.html#.joinTables">joinTables</a></li><li data-type='method'><a href="JoinTables.html#.orJoinIds">orJoinIds</a></li></ul></li><li><a href="PropertyData.html">PropertyData</a><ul class='methods'><li data-type='method'><a href="PropertyData.html#.getData">getData</a></li><li data-type='method'><a href="PropertyData.html#.isExpired">isExpired</a></li></ul></li><li><a href="QueryJoin.html">QueryJoin</a><ul class='methods'><li data-type='method'><a href="QueryJoin.html#getKeyRangeString">getKeyRangeString</a></li><li data-type='method'><a href="QueryJoin.html#join">join</a></li><li data-type='method'><a href="QueryJoin.html#joinCondition">joinCondition</a></li><li data-type='method'><a href="QueryJoin.html#leftSelectFields">leftSelectFields</a></li><li data-type='method'><a href="QueryJoin.html#rightSelectFields">rightSelectFields</a></li><li data-type='method'><a href="QueryJoin.html#selectNotInJoin">selectNotInJoin</a></li><li data-type='method'><a href="QueryJoin.html#.createSelectFieldsString">createSelectFieldsString</a></li><li data-type='method'><a href="QueryJoin.html#.createSelectLabelString">createSelectLabelString</a></li><li data-type='method'><a href="QueryJoin.html#.getJoinField">getJoinField</a></li><li data-type='method'><a href="QueryJoin.html#.ifNaResult">ifNaResult</a></li><li data-type='method'><a href="QueryJoin.html#.replaceColumn">replaceColumn</a></li><li data-type='method'><a href="QueryJoin.html#.sortSelectJoinFields">sortSelectJoinFields</a></li></ul></li><li><a href="Schema.html">Schema</a><ul class='methods'><li data-type='method'><a href="Schema.html#getAllExtendedNotationFieldNames">getAllExtendedNotationFieldNames</a></li><li data-type='method'><a href="Schema.html#getAllFieldNames">getAllFieldNames</a></li><li data-type='method'><a href="Schema.html#getAllVirtualFields">getAllVirtualFields</a></li><li data-type='method'><a href="Schema.html#getColumnNameVariants">getColumnNameVariants</a></li><li data-type='method'><a href="Schema.html#getFieldColumn">getFieldColumn</a></li><li data-type='method'><a href="Schema.html#getFieldColumns">getFieldColumns</a></li><li data-type='method'><a href="Schema.html#load">load</a></li><li data-type='method'><a href="Schema.html#setFieldVariantsColumNumber">setFieldVariantsColumNumber</a></li><li data-type='method'><a href="Schema.html#setTable">setTable</a></li><li data-type='method'><a href="Schema.html#setTableAlias">setTableAlias</a></li><li data-type='method'><a href="Schema.html#setTableData">setTableData</a></li><li data-type='method'><a href="Schema.html#setTableName">setTableName</a></li></ul></li><li><a href="ScriptSettings.html">ScriptSettings</a><ul class='methods'><li data-type='method'><a href="ScriptSettings.html#expire">expire</a></li><li data-type='method'><a href="ScriptSettings.html#get">get</a></li><li data-type='method'><a href="ScriptSettings.html#put">put</a></li><li data-type='method'><a href="ScriptSettings.html#putAll">putAll</a></li></ul></li><li><a href="SelectKeywordAnalysis.html">SelectKeywordAnalysis</a><ul class='methods'><li data-type='method'><a href="SelectKeywordAnalysis.html#.EXCEPT">EXCEPT</a></li><li data-type='method'><a href="SelectKeywordAnalysis.html#.FROM">FROM</a></li><li data-type='method'><a href="SelectKeywordAnalysis.html#.FULL_JOIN">FULL_JOIN</a></li><li data-type='method'><a href="SelectKeywordAnalysis.html#.GROUP_BY">GROUP_BY</a></li><li data-type='method'><a href="SelectKeywordAnalysis.html#.HAVING">HAVING</a></li><li data-type='method'><a href="SelectKeywordAnalysis.html#.INNER_JOIN">INNER_JOIN</a></li><li data-type='method'><a href="SelectKeywordAnalysis.html#.INTERSECT">INTERSECT</a></li><li data-type='method'><a href="SelectKeywordAnalysis.html#.LEFT_JOIN">LEFT_JOIN</a></li><li data-type='method'><a href="SelectKeywordAnalysis.html#.LIMIT">LIMIT</a></li><li data-type='method'><a href="SelectKeywordAnalysis.html#.ORDER_BY">ORDER_BY</a></li><li data-type='method'><a href="SelectKeywordAnalysis.html#.PIVOT">PIVOT</a></li><li data-type='method'><a href="SelectKeywordAnalysis.html#.RIGHT_JOIN">RIGHT_JOIN</a></li><li data-type='method'><a href="SelectKeywordAnalysis.html#.SELECT">SELECT</a></li><li data-type='method'><a href="SelectKeywordAnalysis.html#.UNION">UNION</a></li><li data-type='method'><a href="SelectKeywordAnalysis.html#.UNION_ALL">UNION_ALL</a></li><li data-type='method'><a href="SelectKeywordAnalysis.html#.WHERE">WHERE</a></li><li data-type='method'><a href="SelectKeywordAnalysis.html#.allJoins">allJoins</a></li><li data-type='method'><a href="SelectKeywordAnalysis.html#.analyze">analyze</a></li><li data-type='method'><a href="SelectKeywordAnalysis.html#.extractSelectField">extractSelectField</a></li><li data-type='method'><a href="SelectKeywordAnalysis.html#.getNameAndAlias">getNameAndAlias</a></li><li data-type='method'><a href="SelectKeywordAnalysis.html#.lastIndexOfOutsideLiteral">lastIndexOfOutsideLiteral</a></li><li data-type='method'><a href="SelectKeywordAnalysis.html#.parseForCorrelatedSubQuery">parseForCorrelatedSubQuery</a></li><li data-type='method'><a href="SelectKeywordAnalysis.html#.protect_split">protect_split</a></li><li data-type='method'><a href="SelectKeywordAnalysis.html#.trim">trim</a></li></ul></li><li><a href="SelectTables.html">SelectTables</a><ul class='methods'><li data-type='method'><a href="SelectTables.html#createGroupByKey">createGroupByKey</a></li><li data-type='method'><a href="SelectTables.html#getColumnTitles">getColumnTitles</a></li><li data-type='method'><a href="SelectTables.html#getRecordIDs">getRecordIDs</a></li><li data-type='method'><a href="SelectTables.html#getViewData">getViewData</a></li><li data-type='method'><a href="SelectTables.html#groupBy">groupBy</a></li><li data-type='method'><a href="SelectTables.html#groupByFields">groupByFields</a></li><li data-type='method'><a href="SelectTables.html#having">having</a></li><li data-type='method'><a href="SelectTables.html#join">join</a></li><li data-type='method'><a href="SelectTables.html#orderBy">orderBy</a></li><li data-type='method'><a href="SelectTables.html#removeTempColumns">removeTempColumns</a></li><li data-type='method'><a href="SelectTables.html#resolveBindData">resolveBindData</a></li><li data-type='method'><a href="SelectTables.html#resolveCondition">resolveCondition</a></li><li data-type='method'><a href="SelectTables.html#resolveFieldCondition">resolveFieldCondition</a></li><li data-type='method'><a href="SelectTables.html#resolveSubQuery">resolveSubQuery</a></li><li data-type='method'><a href="SelectTables.html#updateSelectedFields">updateSelectedFields</a></li><li data-type='method'><a href="SelectTables.html#whereCondition">whereCondition</a></li><li data-type='method'><a href="SelectTables.html#.dateToMs">dateToMs</a></li><li data-type='method'><a href="SelectTables.html#.existsCondition">existsCondition</a></li><li data-type='method'><a href="SelectTables.html#.extractStringConstant">extractStringConstant</a></li><li data-type='method'><a href="SelectTables.html#.getConditionValue">getConditionValue</a></li><li data-type='method'><a href="SelectTables.html#.getSubQueryTableSet">getSubQueryTableSet</a></li><li data-type='method'><a href="SelectTables.html#.inCondition">inCondition</a></li><li data-type='method'><a href="SelectTables.html#.isCondition">isCondition</a></li><li data-type='method'><a href="SelectTables.html#.isConditionTrue">isConditionTrue</a></li><li data-type='method'><a href="SelectTables.html#.isStringConstant">isStringConstant</a></li><li data-type='method'><a href="SelectTables.html#.likeCondition">likeCondition</a></li><li data-type='method'><a href="SelectTables.html#.parseForFunctions">parseForFunctions</a></li><li data-type='method'><a href="SelectTables.html#.parseForParams">parseForParams</a></li><li data-type='method'><a href="SelectTables.html#.sortByColumnASC">sortByColumnASC</a></li><li data-type='method'><a href="SelectTables.html#.sortByColumnDESC">sortByColumnDESC</a></li><li data-type='method'><a href="SelectTables.html#.toUpperCaseExceptQuoted">toUpperCaseExceptQuoted</a></li></ul></li><li><a href="Sql.html">Sql</a><ul class='methods'><li data-type='method'><a href="Sql.html#addBindNamedRangeParameter">addBindNamedRangeParameter</a></li><li data-type='method'><a href="Sql.html#addBindParameter">addBindParameter</a></li><li data-type='method'><a href="Sql.html#addTableData">addTableData</a></li><li data-type='method'><a href="Sql.html#areColumnTitlesOutput">areColumnTitlesOutput</a></li><li data-type='method'><a href="Sql.html#clearBindParameters">clearBindParameters</a></li><li data-type='method'><a href="Sql.html#copyTableData">copyTableData</a></li><li data-type='method'><a href="Sql.html#enableColumnTitle">enableColumnTitle</a></li><li data-type='method'><a href="Sql.html#execute">execute</a></li><li data-type='method'><a href="Sql.html#getBindData">getBindData</a></li><li data-type='method'><a href="Sql.html#getTables">getTables</a></li><li data-type='method'><a href="Sql.html#getUniquePivotData">getUniquePivotData</a></li><li data-type='method'><a href="Sql.html#pivotField">pivotField</a></li><li data-type='method'><a href="Sql.html#replaceColumnTableNameWith">replaceColumnTableNameWith</a></li><li data-type='method'><a href="Sql.html#select">select</a></li><li data-type='method'><a href="Sql.html#selectFromSubQuery">selectFromSubQuery</a></li><li data-type='method'><a href="Sql.html#selectJoinSubQuery">selectJoinSubQuery</a></li><li data-type='method'><a href="Sql.html#setBindValues">setBindValues</a></li><li data-type='method'><a href="Sql.html#setTables">setTables</a></li><li data-type='method'><a href="Sql.html#unionSets">unionSets</a></li><li data-type='method'><a href="Sql.html#.addCalculatedPivotFieldsToAst">addCalculatedPivotFieldsToAst</a></li><li data-type='method'><a href="Sql.html#.appendUniqueRows">appendUniqueRows</a></li><li data-type='method'><a href="Sql.html#.distinctField">distinctField</a></li><li data-type='method'><a href="Sql.html#.exceptRows">exceptRows</a></li><li data-type='method'><a href="Sql.html#.extractAstTables">extractAstTables</a></li><li data-type='method'><a href="Sql.html#.getReferencedTableNames">getReferencedTableNames</a></li><li data-type='method'><a href="Sql.html#.getReferencedTableNamesFromAst">getReferencedTableNamesFromAst</a></li><li data-type='method'><a href="Sql.html#.getTableAlias">getTableAlias</a></li><li data-type='method'><a href="Sql.html#.getTableAliasFromJoin">getTableAliasFromJoin</a></li><li data-type='method'><a href="Sql.html#.getTableAliasUnion">getTableAliasUnion</a></li><li data-type='method'><a href="Sql.html#.getTableAliasWhereIn">getTableAliasWhereIn</a></li><li data-type='method'><a href="Sql.html#.getTableAliasWhereTerms">getTableAliasWhereTerms</a></li><li data-type='method'><a href="Sql.html#.getTableNamesCorrelatedSelect">getTableNamesCorrelatedSelect</a></li><li data-type='method'><a href="Sql.html#.getTableNamesFrom">getTableNamesFrom</a></li><li data-type='method'><a href="Sql.html#.getTableNamesJoin">getTableNamesJoin</a></li><li data-type='method'><a href="Sql.html#.getTableNamesUnion">getTableNamesUnion</a></li><li data-type='method'><a href="Sql.html#.getTableNamesWhereCondition">getTableNamesWhereCondition</a></li><li data-type='method'><a href="Sql.html#.getTableNamesWhereIn">getTableNamesWhereIn</a></li><li data-type='method'><a href="Sql.html#.getTableNamesWhereTerms">getTableNamesWhereTerms</a></li><li data-type='method'><a href="Sql.html#.intersectRows">intersectRows</a></li><li data-type='method'><a href="Sql.html#.isIterable">isIterable</a></li><li data-type='method'><a href="Sql.html#.loadSchema">loadSchema</a></li><li data-type='method'><a href="Sql.html#.locateAstTableAlias">locateAstTableAlias</a></li><li data-type='method'><a href="Sql.html#.setTableAlias">setTableAlias</a></li></ul></li><li><a href="SqlParse.html">SqlParse</a><ul class='methods'><li data-type='method'><a href="SqlParse.html#.analyzeParts">analyzeParts</a></li><li data-type='method'><a href="SqlParse.html#.generateSqlSeparatorWords">generateSqlSeparatorWords</a></li><li data-type='method'><a href="SqlParse.html#.generateUsedKeywordList">generateUsedKeywordList</a></li><li data-type='method'><a href="SqlParse.html#.getPositionsOfSqlParts">getPositionsOfSqlParts</a></li><li data-type='method'><a href="SqlParse.html#.hideInnerSql">hideInnerSql</a></li><li data-type='method'><a href="SqlParse.html#.makeSqlPartsSplitterRegEx">makeSqlPartsSplitterRegEx</a></li><li data-type='method'><a href="SqlParse.html#.parseUnion">parseUnion</a></li><li data-type='method'><a href="SqlParse.html#.protect">protect</a></li><li data-type='method'><a href="SqlParse.html#.removeDuplicateEntries">removeDuplicateEntries</a></li><li data-type='method'><a href="SqlParse.html#.reorganizeJoins">reorganizeJoins</a></li><li data-type='method'><a href="SqlParse.html#.reorganizeSpecificJoin">reorganizeSpecificJoin</a></li><li data-type='method'><a href="SqlParse.html#.reorganizeUnions">reorganizeUnions</a></li><li data-type='method'><a href="SqlParse.html#.resolveSqlCondition">resolveSqlCondition</a></li><li data-type='method'><a href="SqlParse.html#.sql2ast">sql2ast</a></li><li data-type='method'><a href="SqlParse.html#.sqlCondition2JsCondition">sqlCondition2JsCondition</a></li><li data-type='method'><a href="SqlParse.html#.sqlStatementSplitter">sqlStatementSplitter</a></li><li data-type='method'><a href="SqlParse.html#.unprotect">unprotect</a></li></ul></li><li><a href="SqlServerFunctions.html">SqlServerFunctions</a><ul class='methods'><li data-type='method'><a href="SqlServerFunctions.html#caseEnd">caseEnd</a></li><li data-type='method'><a href="SqlServerFunctions.html#caseStart">caseStart</a></li><li data-type='method'><a href="SqlServerFunctions.html#caseWhen">caseWhen</a></li><li data-type='method'><a href="SqlServerFunctions.html#convertToJs">convertToJs</a></li><li data-type='method'><a href="SqlServerFunctions.html#parseFunctionArgs">parseFunctionArgs</a></li><li data-type='method'><a href="SqlServerFunctions.html#.charIndex">charIndex</a></li><li data-type='method'><a href="SqlServerFunctions.html#.coalesce">coalesce</a></li><li data-type='method'><a href="SqlServerFunctions.html#.concat">concat</a></li><li data-type='method'><a href="SqlServerFunctions.html#.concat_ws">concat_ws</a></li><li data-type='method'><a href="SqlServerFunctions.html#.convert">convert</a></li></ul></li><li><a href="Table.html">Table</a><ul class='methods'><li data-type='method'><a href="Table.html#addColumnLetters">addColumnLetters</a></li><li data-type='method'><a href="Table.html#concat">concat</a></li><li data-type='method'><a href="Table.html#createCalcFieldRecordMap">createCalcFieldRecordMap</a></li><li data-type='method'><a href="Table.html#createKeyFieldRecordMap">createKeyFieldRecordMap</a></li><li data-type='method'><a href="Table.html#getAllExtendedNotationFieldNames">getAllExtendedNotationFieldNames</a></li><li data-type='method'><a href="Table.html#getAllFieldNames">getAllFieldNames</a></li><li data-type='method'><a href="Table.html#getAllVirtualFields">getAllVirtualFields</a></li><li data-type='method'><a href="Table.html#getColumnCount">getColumnCount</a></li><li data-type='method'><a href="Table.html#getFieldColumn">getFieldColumn</a></li><li data-type='method'><a href="Table.html#getFieldColumns">getFieldColumns</a></li><li data-type='method'><a href="Table.html#getRecords">getRecords</a></li><li data-type='method'><a href="Table.html#loadArrayData">loadArrayData</a></li><li data-type='method'><a href="Table.html#loadNamedRangeData">loadNamedRangeData</a></li><li data-type='method'><a href="Table.html#loadSchema">loadSchema</a></li><li data-type='method'><a href="Table.html#numberToSheetColumnLetter">numberToSheetColumnLetter</a></li><li data-type='method'><a href="Table.html#search">search</a></li><li data-type='method'><a href="Table.html#setHasColumnTitle">setHasColumnTitle</a></li><li data-type='method'><a href="Table.html#setTableAlias">setTableAlias</a></li><li data-type='method'><a href="Table.html#.removeEmptyRecordsAtEndOfTable">removeEmptyRecordsAtEndOfTable</a></li></ul></li><li><a href="TableData.html">TableData</a><ul class='methods'><li data-type='method'><a href="TableData.html#.cacheGetArray">cacheGetArray</a></li><li data-type='method'><a href="TableData.html#.cachePutArray">cachePutArray</a></li><li data-type='method'><a href="TableData.html#.cacheStatusName">cacheStatusName</a></li><li data-type='method'><a href="TableData.html#.fixJSONdates">fixJSONdates</a></li><li data-type='method'><a href="TableData.html#.forceLongCacheExpiryCheck">forceLongCacheExpiryCheck</a></li><li data-type='method'><a href="TableData.html#.getValueCached">getValueCached</a></li><li data-type='method'><a href="TableData.html#.getValuesCached">getValuesCached</a></li><li data-type='method'><a href="TableData.html#.isRangeLoading">isRangeLoading</a></li><li data-type='method'><a href="TableData.html#.isTimeToRunLongCacheExpiry">isTimeToRunLongCacheExpiry</a></li><li data-type='method'><a href="TableData.html#.loadTableData">loadTableData</a></li><li data-type='method'><a href="TableData.html#.loadValuesFromRangeOrSheet">loadValuesFromRangeOrSheet</a></li><li data-type='method'><a href="TableData.html#.lockLoadAndCache">lockLoadAndCache</a></li><li data-type='method'><a href="TableData.html#.setLongCacheExpiry">setLongCacheExpiry</a></li><li data-type='method'><a href="TableData.html#.setValueCached">setValueCached</a></li><li data-type='method'><a href="TableData.html#.setValuesCached">setValuesCached</a></li><li data-type='method'><a href="TableData.html#.verifyCachedData">verifyCachedData</a></li><li data-type='method'><a href="TableData.html#.waitForRangeToLoad">waitForRangeToLoad</a></li></ul></li><li><a href="TableField.html">TableField</a><ul class='methods'><li data-type='method'><a href="TableField.html#addAlias">addAlias</a></li><li data-type='method'><a href="TableField.html#getData">getData</a></li><li data-type='method'><a href="TableField.html#setAggregateFunction">setAggregateFunction</a></li><li data-type='method'><a href="TableField.html#setCalculatedFormula">setCalculatedFormula</a></li><li data-type='method'><a href="TableField.html#setColumnName">setColumnName</a></li><li data-type='method'><a href="TableField.html#setColumnTitle">setColumnTitle</a></li><li data-type='method'><a href="TableField.html#setDistinctSetting">setDistinctSetting</a></li><li data-type='method'><a href="TableField.html#setIsPrimaryTable">setIsPrimaryTable</a></li><li data-type='method'><a href="TableField.html#setIsTempField">setIsTempField</a></li><li data-type='method'><a href="TableField.html#setOriginalTable">setOriginalTable</a></li><li data-type='method'><a href="TableField.html#setOriginalTableColumn">setOriginalTableColumn</a></li><li data-type='method'><a href="TableField.html#setSelectColumn">setSelectColumn</a></li><li data-type='method'><a href="TableField.html#setSubQueryAst">setSubQueryAst</a></li><li data-type='method'><a href="TableField.html#setTableInfo">setTableInfo</a></li><li data-type='method'><a href="TableField.html#.getAllExtendedAliasNames">getAllExtendedAliasNames</a></li></ul></li><li><a href="TableFields.html">TableFields</a><ul class='methods'><li data-type='method'><a href="TableFields.html#addReferencedColumnstoSelectFieldList">addReferencedColumnstoSelectFieldList</a></li><li data-type='method'><a href="TableFields.html#addTempMissingSelectedField">addTempMissingSelectedField</a></li><li data-type='method'><a href="TableFields.html#findTableField">findTableField</a></li><li data-type='method'><a href="TableFields.html#getColumnNames">getColumnNames</a></li><li data-type='method'><a href="TableFields.html#getColumnTitles">getColumnTitles</a></li><li data-type='method'><a href="TableFields.html#getConglomerateFieldCount">getConglomerateFieldCount</a></li><li data-type='method'><a href="TableFields.html#getFieldColumn">getFieldColumn</a></li><li data-type='method'><a href="TableFields.html#getFieldInfo">getFieldInfo</a></li><li data-type='method'><a href="TableFields.html#getNextSelectColumnNumber">getNextSelectColumnNumber</a></li><li data-type='method'><a href="TableFields.html#getSelectFieldColumn">getSelectFieldColumn</a></li><li data-type='method'><a href="TableFields.html#getSelectFields">getSelectFields</a></li><li data-type='method'><a href="TableFields.html#getTableInfo">getTableInfo</a></li><li data-type='method'><a href="TableFields.html#getTempSelectedColumnNumbers">getTempSelectedColumnNumbers</a></li><li data-type='method'><a href="TableFields.html#hasField">hasField</a></li><li data-type='method'><a href="TableFields.html#indexTableField">indexTableField</a></li><li data-type='method'><a href="TableFields.html#loadVirtualFields">loadVirtualFields</a></li><li data-type='method'><a href="TableFields.html#parseAstSelectField">parseAstSelectField</a></li><li data-type='method'><a href="TableFields.html#updateDerivedTableVirtualFields">updateDerivedTableVirtualFields</a></li><li data-type='method'><a href="TableFields.html#updateSelectFieldList">updateSelectFieldList</a></li><li data-type='method'><a href="TableFields.html#.getSelectCountModifiers">getSelectCountModifiers</a></li><li data-type='method'><a href="TableFields.html#.sortPrimaryFields">sortPrimaryFields</a></li></ul></li><li><a href="TestedStatements.html">TestedStatements</a><ul class='methods'><li data-type='method'><a href="TestedStatements.html#getTableDefinitionString">getTableDefinitionString</a></li></ul></li><li><a href="VirtualField.html">VirtualField</a></li><li><a href="VirtualFields.html">VirtualFields</a><ul class='methods'><li data-type='method'><a href="VirtualFields.html#add">add</a></li><li data-type='method'><a href="VirtualFields.html#getAllVirtualFields">getAllVirtualFields</a></li><li data-type='method'><a href="VirtualFields.html#.expandWildcardFields">expandWildcardFields</a></li></ul></li></ul><h3>Global</h3><ul><li><a href="global.html#SQLselfTest">SQLselfTest</a></li><li><a href="global.html#customMenuGenerateTests">customMenuGenerateTests</a></li><li><a href="global.html#gsSQL">gsSQL</a></li><li><a href="global.html#isEqual">isEqual</a></li><li><a href="global.html#onOpen">onOpen</a></li><li><a href="global.html#select2Query">select2Query</a></li><li><a href="global.html#sqlTestCases">sqlTestCases</a></li></ul>
    
</nav>

<div id="main">
    
    <h1 class="page-title">JoinTables.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>//  *** DEBUG START ***
//  Remove comments for testing in NODE

import { Table } from './Table.js';
import { Sql, BindData } from './Sql.js';
import { SqlParse } from './SimpleParser.js';
import { DerivedTable, TableFields, TableField, CalculatedField, SqlServerFunctions } from './Views.js';
export { JoinTables, JoinTablesRecordIds };
//  *** DEBUG END ***/


/** Handle the various JOIN table types. */
class JoinTables {                                   //  skipcq: JS-0128
    constructor() {
        this.joinTableIDs = new JoinTablesRecordIds(this);
        this.tableFields = null;
        this.bindVariables = null;
        this.tableInfo = null;
    }

    /**
     * 
     * @param {Map&lt;String,Table>} tableInfo - Map of table info.
     * @returns {JoinTables}
     */
    setTableInfo(tableInfo) {
        this.tableInfo = tableInfo;
        this.joinTableIDs.setTableInfo(tableInfo);
        return this;
    }

    /**
     * 
     * @param {TableFields} tableFields 
     * @returns {JoinTables}
     */
    setTableFields(tableFields) {
        this.tableFields = tableFields;
        this.joinTableIDs.setTableFields(tableFields);
        return this;
    }

    /**
     * 
     * @param {BindData} bindVariables - Bind variable data. 
     * @returns {JoinTables}
     */
    setBindVariables(bindVariables) {
        this.bindVariables = bindVariables;
        this.joinTableIDs.setBindVariables(bindVariables);
        return this;
    }

    /**
     * 
     * @param {Table} primaryTableInfo 
     * @returns {JoinTables}
     */
    setPrimaryTableInfo(primaryTableInfo) {
        this.primaryTableInfo = primaryTableInfo;
        this.joinTableIDs.setPrimaryTableInfo(primaryTableInfo);
        return this;
    }

    /**
     * Join the tables and create a derived table with the combined data from all.
     * @param {Object} ast - AST list of tables to join.
     */
    load(ast) {
        /** @property {DerivedTable} - result table after tables are joined */
        this.derivedTable = new DerivedTable();

        for (const joinTable of ast.JOIN) {
            this.joinNextTable(joinTable, ast.FROM.table.toUpperCase());
        }
    }

    /**
     * Updates derived table with join to new table.
     * @param {Object} astJoin
     * @param {String} leftTableName
     */
    joinNextTable(astJoin, leftTableName) {
        const recIds = this.joinCondition(astJoin, leftTableName);

        const joinFieldsInfo = this.joinTableIDs.getJoinFieldsInfo();
        this.derivedTable = JoinTables.joinTables(joinFieldsInfo, astJoin, recIds);

        //  Field locations have changed to the derived table, so update our
        //  virtual field list with proper settings.
        this.tableFields.updateDerivedTableVirtualFields(this.derivedTable);
    }

    /**
     *
     * @param {Object} conditions
     * @param {String} leftTableName
     * @returns {Array}
     */
    joinCondition(conditions, leftTableName) {
        let recIds = [];
        const rightTableName = conditions.table;
        const joinType = conditions.type;

        if (typeof conditions.cond.logic === 'undefined')
            recIds = this.resolveCondition("OR", [conditions], joinType, rightTableName, leftTableName);

        else
            recIds = this.resolveCondition(conditions.cond.logic, conditions.cond.terms, joinType, rightTableName, leftTableName);

        return recIds;
    }

    /**
     *
     * @param {String} logic - AND, OR
     * @param {Object} astConditions
     * @param {String} joinType - inner, full, left, right
     * @param {String} rightTableName - right join table.
     * @param {String} leftTableName - left join table name
     * @returns {Array}
     */
    resolveCondition(logic, astConditions, joinType, rightTableName, leftTableName) {
        let leftIds = [];
        let rightIds = [];
        let resultsLeft = [];
        let resultsRight = [];
        this.joinTableIDs
            .setLeftTableName(leftTableName)
            .setRightTableName(rightTableName)
            .setJoinType(joinType)
            .setTableFields(this.tableFields);

        for (const cond of astConditions) {
            if (typeof cond.logic === 'undefined') {
                [leftIds, rightIds] = this.joinTableIDs.getRecordIDs(cond);
                resultsLeft.push(leftIds);
                resultsRight.push(rightIds);
            }
            else {
                [leftIds, rightIds] = this.resolveCondition(cond.logic, cond.terms, joinType, rightTableName, leftTableName);
                resultsLeft.push(leftIds);
                resultsRight.push(rightIds);
            }
        }

        if (logic === "AND") {
            resultsLeft = JoinTables.andJoinIds(resultsLeft);
            resultsRight = JoinTables.andJoinIds(resultsRight);
        }
        if (logic === "OR") {
            resultsLeft = JoinTables.orJoinIds(resultsLeft);
            resultsRight = JoinTables.orJoinIds(resultsRight);
        }

        return [resultsLeft, resultsRight];
    }

    /**
     * AND logic applied to the record ID's
     * @param {Array} recIds
     * @returns {Array}
     */
    static andJoinIds(recIds) {
        const result = [];

        for (let i = 0; i &lt; recIds[0].length; i++) {
            const temp = [];

            for (const rec of recIds) {
                temp.push(typeof rec[i] === 'undefined' ? [] : rec[i]);
            }
            const row = temp.reduce((a, b) => a.filter(c => b.includes(c)));

            if (row.length > 0) {
                result[i] = row;
            }
        }

        return result;
    }

    /**
     * OR logic applied to the record ID's
     * @param {Array} recIds
     * @returns {Array}
     */
    static orJoinIds(recIds) {
        const result = [];

        for (let i = 0; i &lt; recIds[0].length; i++) {
            let temp = [];

            for (const rec of recIds) {
                temp = temp.concat(rec[i]);
            }

            if (typeof temp[0] !== 'undefined') {
                result[i] = Array.from(new Set(temp));
            }
        }

        return result;
    }

    /**
     * Does this object contain a derived (joined) table.
     * @returns {Boolean}
     */
    isDerivedTable() {
        if (typeof this.derivedTable === 'undefined') {
            return false;
        }

        return this.derivedTable.isDerivedTable();
    }

    /**
     * Get derived table after tables are joined.
     * @returns {Table}
     */
    getJoinedTableInfo() {
        return this.derivedTable.getTableData();
    }

    /**
    * Join two tables and create a derived table that contains all data from both tables.
    * @param {LeftRightJoinFields} leftRightFieldInfo - left table field of join
    * @param {Object} joinTable - AST that contains join type.
    * @param {Array} recIds
    * @returns {DerivedTable} - new derived table after join of left and right tables.
    */
    static joinTables(leftRightFieldInfo, joinTable, recIds) {
        let derivedTable = null;
        let rightDerivedTable = null;

        const [matchedRecordIDs, rightJoinRecordIDs] = recIds;

        switch (joinTable.type) {
            case "left":
                derivedTable = new DerivedTable()
                    .setLeftField(leftRightFieldInfo.leftSideInfo.fieldInfo)
                    .setRightField(leftRightFieldInfo.rightSideInfo.fieldInfo)
                    .setLeftRecords(matchedRecordIDs)
                    .setIsOuterJoin(true)
                    .createTable();
                break;

            case "inner":
                derivedTable = new DerivedTable()
                    .setLeftField(leftRightFieldInfo.leftSideInfo.fieldInfo)
                    .setRightField(leftRightFieldInfo.rightSideInfo.fieldInfo)
                    .setLeftRecords(matchedRecordIDs)
                    .setIsOuterJoin(false)
                    .createTable();
                break;

            case "right":
                derivedTable = new DerivedTable()
                    .setLeftField(leftRightFieldInfo.rightSideInfo.fieldInfo)
                    .setRightField(leftRightFieldInfo.leftSideInfo.fieldInfo)
                    .setLeftRecords(matchedRecordIDs)
                    .setIsOuterJoin(true)
                    .createTable();

                break;

            case "full":
                derivedTable = new DerivedTable()
                    .setLeftField(leftRightFieldInfo.leftSideInfo.fieldInfo)
                    .setRightField(leftRightFieldInfo.rightSideInfo.fieldInfo)
                    .setLeftRecords(matchedRecordIDs)
                    .setIsOuterJoin(true)
                    .createTable();

                rightDerivedTable = new DerivedTable()
                    .setLeftField(leftRightFieldInfo.rightSideInfo.fieldInfo)
                    .setRightField(leftRightFieldInfo.leftSideInfo.fieldInfo)
                    .setLeftRecords(rightJoinRecordIDs)
                    .setIsOuterJoin(true)
                    .createTable();

                derivedTable.tableInfo.concat(rightDerivedTable.tableInfo); // skipcq: JS-D008

                break;

            default:
                throw new Error(`Internal error.  No support for join type: ${joinTable.type}`);
        }
        return derivedTable;
    }
}

class JoinTablesRecordIds {
    constructor(joinTables) {
        this.dataJoin = joinTables;
        this.tableFields = null;
        /** @type {LeftRightJoinFields} */
        this.joinFields = null;
        this.tableFields = null;
        this.tableInfo = null;
        this.bindVariables = null;
        this.primaryTableInfo = null
        /** @type {Table} */
        this.masterTable = null;
        this.rightTableName = "";
        this.leftTableName = "";
        this.joinType = "";
    }

    /**
     *
     * @param {Object} conditionAst
     * @returns {Array}
     */
    getRecordIDs(conditionAst) {
        /** @type {Table} */
        this.masterTable = this.dataJoin.isDerivedTable() ? this.dataJoin.getJoinedTableInfo() : this.primaryTableInfo;
        this.calcSqlField = new CalculatedField(this.masterTable, this.primaryTableInfo, this.tableFields);

        this.joinFields = this.getLeftRightFieldInfo(conditionAst);
        const recIds = this.getMatchedRecordIds();

        return recIds;
    }

    /**
     * 
     * @param {TableFields} tableFields 
     * @returns {JoinTablesRecordIds}
     */
    setTableFields(tableFields) {
        this.tableFields = tableFields;
        return this;
    }

    /**
     * 
     * @param {Map&lt;String,Table>} tableInfo - Map of table info.
     * @returns {JoinTablesRecordIds}
     */
    setTableInfo(tableInfo) {
        this.tableInfo = tableInfo;
        return this;
    }

    /**
     * 
     * @param {BindData} bindVariables - Bind variable data. 
     * @returns {JoinTablesRecordIds}
     */
    setBindVariables(bindVariables) {
        this.bindVariables = bindVariables;
        return this;
    }

    /**
     * 
     * @param {String} name 
     * @returns {JoinTablesRecordIds}
     */
    setRightTableName(name) {
        this.rightTableName = name;
        return this;
    }

    /**
     * 
     * @param {String} name 
     * @returns {JoinTablesRecordIds}
     */
    setLeftTableName(name) {
        this.leftTableName = name;
        return this;
    }

    /**
     * 
     * @param {String} joinType 
     * @returns {JoinTablesRecordIds}
     */
    setJoinType(joinType) {
        this.joinType = joinType;
        return this;
    }

    /**
     * 
     * @param {Table} primaryTableInfo 
     * @returns {JoinTablesRecordIds}
    */
    setPrimaryTableInfo(primaryTableInfo) {
        this.primaryTableInfo = primaryTableInfo;
        return this;
    }

    /**
     * 
     * @returns {LeftRightJoinFields}
     */
    getJoinFieldsInfo() {
        return this.joinFields;
    }

    /**
     * @typedef {Object} LeftRightJoinFields
     * @property {JoinSideInfo} leftSideInfo
     * @property {JoinSideInfo} rightSideInfo
     * 
     */

    /**
     * @typedef {Object} JoinSideInfo
     * @property {TableField} fieldInfo
     * @property {String} column
     */

    /**
     *
     * @param {Object} astJoin
     * @returns {LeftRightJoinFields}
     */
    getLeftRightFieldInfo(astJoin) {
        /** @type {TableField} */
        let leftFieldInfo = null;
        /** @type {TableField} */
        let rightFieldInfo = null;

        const left = typeof astJoin.cond === 'undefined' ? astJoin.left : astJoin.cond.left;
        const right = typeof astJoin.cond === 'undefined' ? astJoin.right : astJoin.cond.right;

        leftFieldInfo = this.getTableInfoFromCalculatedField(left);
        rightFieldInfo = this.getTableInfoFromCalculatedField(right);

        /** @type {JoinSideInfo} */
        const leftSideInfo = {
            fieldInfo: leftFieldInfo,
            column: left
        };
        /** @type {JoinSideInfo} */
        const rightSideInfo = {
            fieldInfo: rightFieldInfo,
            column: right
        }

        //  joinTable.table is the RIGHT table, so switch if equal to condition left.
        if (typeof leftFieldInfo !== 'undefined' &amp;&amp; this.rightTableName === leftFieldInfo.originalTable) {
            return {
                leftSideInfo: rightSideInfo,
                rightSideInfo: leftSideInfo
            };
        }

        return { leftSideInfo, rightSideInfo };
    }

    /**
     * Look for referenced columns in expression to determine table.
     * @param {String} calcField - Expression to parse.  
     * @returns {TableField} - All SQL function parameters found.  It will include COLUMN names and constant data.
     */
    getTableInfoFromCalculatedField(calcField) {
        let foundTableField = this.tableFields.getFieldInfo(calcField);

        if (typeof foundTableField === 'undefined' &amp;&amp; calcField !== '') {
            //  Calculated expression.
            foundTableField = this.getReferencedTableInfo(calcField);
        }

        return foundTableField;
    }

    /**
     * 
     * @param {String} calcField 
     * @returns {TableField}
     */
    getReferencedTableInfo(calcField) {
        let foundTableField = null;
        const sqlFunc = new SqlServerFunctions();

        //  A side effect when converting an expression to Javascript is that we have a list
        //  of referenced column data (referenced in SQL functions)
        sqlFunc.convertToJs(calcField, this.tableFields.allFields);
        const columns = sqlFunc.getReferencedColumns();

        foundTableField = this.searchColumnsForTable(calcField, columns);
        if (foundTableField !== null)
            return foundTableField;

        //  No functions with parameters were used in 'calcField', so we don't know table yet.
        //  We search the calcField for valid columns - except within quotes.
        const quotedConstantsRegEx = /["'](.*?)["']/g;
        const opRegEx = /[+\-/*()]/g;
        const results = calcField.replace(quotedConstantsRegEx, "");
        let parts = results.split(opRegEx);
        parts = parts.map(a => a.trim()).filter(a => a !== '');

        foundTableField = this.searchColumnsForTable(calcField, parts);

        if (foundTableField === null) {
            throw new Error(`Failed to JOIN:  ${calcField}`);
        }

        return foundTableField;
    }

    /**
     * 
     * @param {String} calcField 
     * @param {String[]} columns 
     * @returns {TableField}
     */
    searchColumnsForTable(calcField, columns) {
        let fieldInfo = null;
        let foundTableField = null;

        for (const col of columns) {
            fieldInfo = this.tableFields.getFieldInfo(col);
            if (typeof fieldInfo !== 'undefined') {
                foundTableField = Object.assign({}, fieldInfo);
                foundTableField.calculatedFormula = calcField;
                return foundTableField;
            }
        }

        return foundTableField;
    }

    /**
     *
     * @returns {Array}
     */
    getMatchedRecordIds() {
        /** @type {Number[][]} */
        let matchedRecordIDs = [];
        let rightJoinRecordIDs = [];

        switch (this.joinType) {
            case "left":
                matchedRecordIDs = this.leftRightJoin(this.joinFields.leftSideInfo, this.joinFields.rightSideInfo, this.joinType);
                break;
            case "inner":
                matchedRecordIDs = this.leftRightJoin(this.joinFields.leftSideInfo, this.joinFields.rightSideInfo, this.joinType);
                break;
            case "right":
                matchedRecordIDs = this.leftRightJoin(this.joinFields.rightSideInfo, this.joinFields.leftSideInfo, this.joinType);
                break;
            case "full":
                matchedRecordIDs = this.leftRightJoin(this.joinFields.leftSideInfo, this.joinFields.rightSideInfo, this.joinType);
                rightJoinRecordIDs = this.leftRightJoin(this.joinFields.rightSideInfo, this.joinFields.leftSideInfo, "outer");
                break;
            default:
                throw new Error(`Invalid join type: ${this.joinType}`);
        }


        return [matchedRecordIDs, rightJoinRecordIDs];
    }

    /**
     * Returns array of each matching record ID from right table for every record in left table.
     * If the right table entry could NOT be found, -1 is set for that record index.
     * @param {JoinSideInfo} leftField - left table field
     * @param {JoinSideInfo} rightField - right table field
     * @param {String} type - either 'inner' or 'outer'.
     * @returns {Number[][]} - first index is record ID of left table, second index is a list of the matching record ID's in right table.
    */
    leftRightJoin(leftField, rightField, type) {
        const leftRecordsIDs = [];

        //  First record is the column title.
        leftRecordsIDs.push([0]);

        const leftTableData = leftField.fieldInfo.tableInfo.tableData;

        //  Map the RIGHT JOIN key to record numbers.
        const keyFieldMap = this.createKeyFieldRecordMap(rightField);

        let keyMasterJoinField = null;
        for (let leftTableRecordNum = 1; leftTableRecordNum &lt; leftTableData.length; leftTableRecordNum++) {
            keyMasterJoinField = this.getJoinColumnData(leftField, leftTableRecordNum);

            const joinRows = !keyFieldMap.has(keyMasterJoinField) ? [] : keyFieldMap.get(keyMasterJoinField);

            //  For the current LEFT TABLE record, record the linking RIGHT TABLE records.
            if (joinRows.length === 0) {
                if (type === "inner")
                    continue;

                leftRecordsIDs[leftTableRecordNum] = [-1];
            }
            else {
                //  Excludes all match recordgs (is outer the right word for this?)
                if (type === "outer")
                    continue;

                leftRecordsIDs[leftTableRecordNum] = joinRows;
            }
        }

        return leftRecordsIDs;
    }

    /**
     * 
     * @param {JoinSideInfo} fieldInfo 
     * @param {Number} recordNumber
     * @returns {String}
     */
    getJoinColumnData(fieldInfo, recordNumber) {
        let keyMasterJoinField = null;
        const tableColumnNumber = fieldInfo.fieldInfo.tableColumn;

        if (typeof tableColumnNumber !== 'undefined') {
            keyMasterJoinField = fieldInfo.fieldInfo.tableInfo.tableData[recordNumber][tableColumnNumber];
        }
        else {
            keyMasterJoinField = this.calcSqlField.evaluateCalculatedField(fieldInfo.column, recordNumber);
        }

        if (keyMasterJoinField !== null) {
            keyMasterJoinField = keyMasterJoinField.toString();
        }    

        return keyMasterJoinField;
    }

    /**
     * 
     * @param {JoinSideInfo} rightField 
     * @returns {Map&lt;String, Number[]>}
     */
    createKeyFieldRecordMap(rightField) {
        let keyFieldMap = null;

        if (typeof rightField.fieldInfo.tableColumn !== 'undefined') {
            keyFieldMap = rightField.fieldInfo.tableInfo.createKeyFieldRecordMap(rightField.fieldInfo.fieldName);
        }
        else {
            //  We have to evalulate the expression for every record and put into the key map (with record ID's)
            const rightSideCalculator = new CalculatedField(rightField.fieldInfo.tableInfo, rightField.fieldInfo.tableInfo, this.tableFields);
            keyFieldMap = rightField.fieldInfo.tableInfo.createCalcFieldRecordMap(rightSideCalculator, rightField.fieldInfo.calculatedFormula);
        }

        return keyFieldMap;
    }
}
</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 4.0.0</a> on Sat Apr 29 2023 15:23:38 GMT-0400 (Eastern Daylight Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>

<script src="scripts/search.js" defer></script>



</body>
</html>
